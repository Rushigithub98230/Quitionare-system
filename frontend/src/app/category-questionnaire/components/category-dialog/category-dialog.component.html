<h2 mat-dialog-title>{{ data.mode === 'create' ? 'Create Category' : 'Edit Category' }}</h2>

<form [formGroup]="categoryForm" (ngSubmit)="onSubmit()">
  <mat-dialog-content>
    <div class="form-row">
      <mat-form-field appearance="outline">
        <mat-label>Name</mat-label>
        <input matInput formControlName="name" placeholder="Enter category name">
        <mat-error *ngIf="categoryForm.get('name')?.hasError('required')">
          Name is required
        </mat-error>
        <mat-error *ngIf="categoryForm.get('name')?.hasError('maxlength')">
          Name must be less than 100 characters
        </mat-error>
        <mat-error *ngIf="categoryForm.get('name')?.hasError('duplicate')">
          A category with this name already exists
        </mat-error>
        <mat-error *ngIf="categoryForm.get('name')?.hasError('duplicateInactive')">
          This category already exists and is currently inactive
        </mat-error>
        <mat-hint *ngIf="nameChecking" class="checking-hint">
          <mat-icon>hourglass_empty</mat-icon> Checking name availability...
        </mat-hint>
        <mat-hint *ngIf="!nameChecking && categoryForm.get('name')?.valid && !categoryForm.get('name')?.hasError('duplicate')" class="available-hint">
          <mat-icon>check_circle</mat-icon> Name is available
        </mat-hint>
      </mat-form-field>
    </div>

    <div class="form-row">
      <mat-form-field appearance="outline" class="full-width">
        <mat-label>Description</mat-label>
        <textarea matInput formControlName="description" placeholder="Enter category description" rows="3"></textarea>
        <mat-error *ngIf="categoryForm.get('description')?.hasError('maxlength')">
          Description must be less than 500 characters
        </mat-error>
      </mat-form-field>
    </div>

    <div class="form-row">
      <mat-form-field appearance="outline">
        <mat-label>Color</mat-label>
        <input matInput formControlName="color" placeholder="#007bff">
        <mat-error *ngIf="categoryForm.get('color')?.hasError('pattern')">
          Please enter a valid hex color
        </mat-error>
        <mat-error *ngIf="categoryForm.get('color')?.hasError('maxlength')">
          Color must be less than 100 characters
        </mat-error>
      </mat-form-field>
    </div>

    <div class="form-row">
      <mat-form-field appearance="outline">
        <mat-label>Base Price</mat-label>
        <input matInput type="number" formControlName="basePrice" placeholder="0.00" step="0.01">
        <mat-error *ngIf="categoryForm.get('basePrice')?.hasError('min')">
          Base price must be at least 0
        </mat-error>
      </mat-form-field>

      <mat-form-field appearance="outline">
        <mat-label>Consultation Duration (minutes)</mat-label>
        <input matInput type="number" formControlName="oneTimeConsultationDurationMinutes" placeholder="30">
        <mat-error *ngIf="categoryForm.get('oneTimeConsultationDurationMinutes')?.hasError('min')">
          Duration must be at least 1 minute
        </mat-error>
      </mat-form-field>
    </div>

    <div class="form-row">
      <mat-form-field appearance="outline" class="full-width">
        <mat-label>Consultation Description</mat-label>
        <textarea matInput formControlName="consultationDescription" placeholder="Enter consultation description" rows="2"></textarea>
        <mat-error *ngIf="categoryForm.get('consultationDescription')?.hasError('maxlength')">
          Consultation description must be less than 500 characters
        </mat-error>
      </mat-form-field>
    </div>

    <div class="form-row">
      <mat-form-field appearance="outline" class="full-width">
        <mat-label>Features</mat-label>
        <textarea matInput formControlName="features" placeholder="Enter features (comma separated)" rows="2"></textarea>
        <mat-error *ngIf="categoryForm.get('features')?.hasError('maxlength')">
          Features must be less than 1000 characters
        </mat-error>
      </mat-form-field>
    </div>

    <div class="form-row">
      <mat-form-field appearance="outline">
        <mat-label>Icon</mat-label>
        <input matInput formControlName="icon" placeholder="Enter icon name">
        <mat-error *ngIf="categoryForm.get('icon')?.hasError('maxlength')">
          Icon must be less than 100 characters
        </mat-error>
      </mat-form-field>
    </div>

    <div class="checkbox-row">
      <mat-checkbox formControlName="isActive">Active</mat-checkbox>
      <mat-checkbox formControlName="allowsFollowUpMessaging">Allows Follow-up Messaging</mat-checkbox>
      <mat-checkbox formControlName="allowsMedicationDelivery">Allows Medication Delivery</mat-checkbox>
      <mat-checkbox formControlName="isMostPopular">Most Popular</mat-checkbox>
      <mat-checkbox formControlName="isTrending">Trending</mat-checkbox>
      <mat-checkbox formControlName="requiresQuestionnaireAssessment">Requires Questionnaire Assessment</mat-checkbox>
    </div>
  </mat-dialog-content>

  <mat-dialog-actions align="end">
    <button mat-button type="button" (click)="onCancel()">Cancel</button>
    <button mat-raised-button color="primary" type="submit" [disabled]="categoryForm.invalid || loading">
      <mat-icon *ngIf="loading">hourglass_empty</mat-icon>
      {{ data.mode === 'create' ? 'Create' : 'Update' }}
    </button>
  </mat-dialog-actions>
</form> 